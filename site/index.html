<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Precursor | Pre-Protocol Similarity Triage</title>
  <meta name="description"
    content="Precursor turns raw payloads into protocol hints, similarity clusters, and fast triage output." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=IBM+Plex+Mono:wght@400;500&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
  <!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "e26f679adf2e457baf5617c0fd4b466a"}'></script><!-- End Cloudflare Web Analytics -->
</head>

<body>
  <div class="bg-layer"></div>
  <main>
    <header class="hero">
      <p class="kicker">precursor.hashdb.io</p>
      <h1>Pre-Protocol Payload Triage for Packets, Logs, and Firmware Fragments</h1>
      <p class="hero-copy">
        Precursor tags payloads with named captures, clusters near-matches with
        TLSH/LZJD/FBHash (and optional MRSHv2 adapter mode), and emits JSON designed
        for SOC pipelines and LLM-guided protocol discovery loops.
      </p>
      <div class="hero-cta">
        <a href="https://github.com/Obsecurus/precursor" target="_blank" rel="noreferrer">GitHub</a>
        <a href="#demo">Try Demo Scenarios</a>
      </div>
    </header>

    <section class="stats">
      <article>
        <h2>Dual Input Shapes</h2>
        <p>Text/base64/hex plus raw-binary blob support via <code>-B</code>.</p>
      </article>
      <article>
        <h2>Similarity Modes</h2>
        <p>TLSH + LZJD + FBHash implemented, MRSHv2 available behind native adapter feature.</p>
      </article>
      <article>
        <h2>Detection Inputs</h2>
        <p>PCRE files, Sigma keyword YAML, or inline patterns feed the same triage pipeline.</p>
      </article>
    </section>

    <section class="teaser" aria-label="Why install teaser">
      <div class="teaser-head">
        <h2>Why Install Precursor</h2>
        <p>
          One command turns opaque payload streams into tags, clusters, and
          protocol confidence output you can act on immediately.
        </p>
      </div>
      <div class="teaser-stage">
        <article class="teaser-lane">
          <h3>Input stream</h3>
          <div class="chip-stack">
            <span class="chip chip-http">GET /admin HTTP/1.1</span>
            <span class="chip chip-tls">16 03 03 ...</span>
            <span class="chip chip-ics">00 01 00 00 00 06 11 03 ...</span>
          </div>
        </article>
        <div class="teaser-arrow" aria-hidden="true">→</div>
        <article class="teaser-lane">
          <h3>Tag + similarity</h3>
          <ul class="teaser-list">
            <li><code>tags: ["http_method"]</code></li>
            <li><code>similarity_hash: "lzjd:..."</code></li>
            <li><code>tlsh_similarities: {...}</code></li>
          </ul>
        </article>
        <div class="teaser-arrow" aria-hidden="true">→</div>
        <article class="teaser-lane">
          <h3>Actionable triage</h3>
          <div class="cluster-view">
            <div class="cluster-row">
              <span>http</span>
              <strong>0.93</strong>
            </div>
            <div class="cluster-row">
              <span>tls</span>
              <strong>0.90</strong>
            </div>
            <div class="cluster-row">
              <span>firmware_binary</span>
              <strong>0.86</strong>
            </div>
          </div>
        </article>
      </div>
      <div class="teaser-terminal">
        <div class="code-head">
          <span>Sample JSON line</span>
        </div>
        <pre><code>{"protocol_label":"http","protocol_confidence":0.93,"similarity_hash":"lzjd:128:...","tags":["http_method"]}</code></pre>
      </div>
    </section>

    <section id="demo" class="demo">
      <div class="demo-head">
        <h2>Scenario Demos</h2>
        <p>These examples map directly to files committed under <code>samples/scenarios/</code>.</p>
      </div>
      <nav class="scenario-tabs" id="scenario-tabs" aria-label="Scenario tabs"></nav>
      <article class="scenario-panel" id="scenario-panel">
        <h3 id="scenario-title"></h3>
        <p id="scenario-description"></p>
        <div class="code-wrap">
          <div class="code-head">
            <span>Command</span>
            <button id="copy-command" type="button">Copy</button>
          </div>
          <pre><code id="scenario-command"></code></pre>
        </div>
        <div class="code-wrap">
          <div class="code-head">
            <span>Expected signal</span>
          </div>
          <pre><code id="scenario-output"></code></pre>
        </div>
      </article>
    </section>

    <section id="reels" class="reels">
      <div class="demo-head">
        <h2>Mini Demo Reels</h2>
        <p>Short terminal playbacks built from real scenario output snapshots.</p>
      </div>
      <nav class="reel-tabs" id="reel-tabs" aria-label="Demo reel tabs"></nav>
      <article class="reel-player">
        <div class="code-head">
          <span id="reel-title"></span>
          <button id="reel-play" type="button">Replay</button>
        </div>
        <pre><code id="reel-frame"></code></pre>
      </article>
    </section>

    <section id="stats-mode" class="stats-mode">
      <div class="demo-head">
        <h2>Stats Mode Explained</h2>
        <p>
          Run with <code>--stats</code> to emit a structured run summary on <code>stderr</code> while
          keeping payload records on <code>stdout</code>.
        </p>
      </div>
      <div class="stats-mode-grid">
        <article class="stats-legend">
          <h3>What You Get</h3>
          <ul>
            <li><code>Input</code>: volume and size profile of all processed payloads.</li>
            <li><code>Match</code>: pattern counts, hit totals, and hash generation counts.</li>
            <li><code>Compare</code>: distance summary when enough pairwise comparisons exist.</li>
            <li><code>Environment</code>: execution context, including similarity and regex mode.</li>
          </ul>
          <p class="stats-note">
            This makes it easy to add basic health checks, throughput baselines, and release regression
            guardrails without parsing full result streams.
          </p>
        </article>
        <article class="stats-viz">
          <h3>Sample Snapshot</h3>
          <div id="stats-bars" class="stats-bars" aria-label="Sample stats bars"></div>
          <div class="code-wrap">
            <div class="code-head">
              <span>Sample --stats JSON</span>
            </div>
            <pre><code id="stats-json"></code></pre>
          </div>
        </article>
      </div>
    </section>

    <section class="use-cases">
      <h2>High-Impact Use Cases</h2>
      <div class="cards">
        <article>
          <h3>Exploit Spray Triage</h3>
          <p>Cluster evasive probe families before parser development and identify repeated payload mutations quickly.
          </p>
        </article>
        <article>
          <h3>Sigma-to-Stream Validation</h3>
          <p>Reuse Sigma keyword intent directly against shell/log streams to validate or tune detections.</p>
        </article>
        <article>
          <h3>Firmware + DNS Hunt Pivoting</h3>
          <p>Tag binary fragments and suspicious DNS query families in one JSON-first workflow.</p>
        </article>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
</body>

</html>
